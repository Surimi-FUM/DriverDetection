# DriverDetection
Deep Learningで車のペダル踏み間違い事故を防止するプロジェクトで作成した  

![predict12](https://user-images.githubusercontent.com/116449282/229969539-f1f97d02-dc72-46ce-b2e5-09abd3bb2d19.jpg)  

![predict1](https://user-images.githubusercontent.com/116449282/229969756-98147c59-160b-46d9-9c6b-e3dc3e09d374.jpg)  

当初はCNNによる分類を行ったが、ペダルがある領域が暗すぎるためCNNでは足元を検出することができなかった。  
対策として、手動でセグメンテーションを施した画像を使用したら精度が向上した。  
その結果から、セグメンテーションモデルが有効と考え、今回のUNetの実装を行った。  
教師データは、用意した独自データセットではデータの多様性が乏しかったため、公開されているPascal VOC 2012を使用することにした。  

## 概要  
車の運転手のセグメンテーションを目的としたU-Netモデルです。  
2015年に提案された標準モデルにバッチ正規化層を追加し、損失関数をDice係数Lossに変更しています。  
カラー画像を入力として受け取り、人体部分のマスク画像を出力します。  
精度は粗いが、目視で確認できないほどの暗い領域にある足に反応した結果が得られます。  

## 結果  
推論モデルとして、2015年に提案された標準モデル、標準モデルにバッチ正規化層を追加したモデル、損失関数をDice係数lossに変更したモデル、二つを組み合わせたモデルの4種類を構築した。  
それぞれunet、unetBN、unetDL、unetBNDLに区分する。  
検証データ178枚に対するMeanIoUを計算した結果は(unet, unetDL, unetBN, unetBNDL) = (0.4179, 0.4154, 0.5740, 0.6087)となった。  
この結果からunetBNDLが一番精度のよいモデルであると推測される。  
unetBNDLでは、他モデルと比べてセグメンテーション領域が広がり改善がみられた。  
しかし、セグメンテーション領域は途切れ途切れな状態であり、ハンドルを持つ腕部分は大雑把に過剰反応していた。  
出力されたマスク画像から人体像を認識することはできない精度ではあるものの、今までの進捗の中でとらえられていなかった足元に対して反応している結果が得られた。  

## アピールポイント  
課題に適したデータセットの作成を行う工夫をしました。  
「AIを活用した車の踏み間違い事故検出」という研究のリサーチアシスタントとして取り組んだ背景があり、その課題に対して運転手の右足がアクセルとブレーキのどちらにかかっているかを検出するアプローチを取りました。  
しかし、車の運転手の足元を写したデータはWebで探しても十分には見つからず、既存のデータセットも存在しませんでした。  
そのため、助手席にカメラを設置して自分自身が運転する様子を撮影し、データを収集しました。  
独自データセットを作成したことで、実験をスムーズに進めることができました。ただし、データをフレームワークに適した形式に加工する作業も自分で行わなければならず大変でした。  
データの加工を容易にするために、1つのファイルに1つの機能を意識して画像処理用の関数を作成しました。  
また、メモリに大量の画像データを格納することができなかったため、学習に必要な枚数だけを取り出すジェネレータも自作しました。  
この開発の経験により、AI技術の基礎を習得することができました。また、漠然とした課題に対して解決策を探求する能力も培われました。  

## 開発環境
PC：Windows 10 Education、Intel Core i7-7700K  
メモリ：32.0GB  
GPU：NVIDIA GeForce GTX 1080  

### テスト環境
開発環境と同じ  

## 開発期間・人数  
令和3年(2021)/05 ~ 令和4年(2022)/02、1人  
令和4年(2022)/05 ~ 令和5年(2023)/02、1人  
